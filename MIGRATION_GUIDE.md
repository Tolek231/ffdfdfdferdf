# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### ‚úÖ –£–¥–∞–ª–µ–Ω–æ
- `src/legacy/` ‚Äî –≤–µ—Å—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫–æ–¥
- `src/bot/index.js` ‚Äî —Å—Ç–∞—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
- `src/web/static.js` ‚Äî –¥—É–±–ª–∏—Ä—É—é—â–∏–π –∫–æ–¥
- `public/111.json` ‚Äî –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ñ–∞–π–ª
- `README_COUNTERS_PATCH.txt` ‚Äî —É—Å—Ç–∞—Ä–µ–≤—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### ‚ú® –°–æ–∑–¥–∞–Ω–æ
- `src/routes/` ‚Äî –º–æ–¥—É–ª—å–Ω—ã–µ HTTP –º–∞—Ä—à—Ä—É—Ç—ã
- `src/bot/telegram.js` ‚Äî –Ω–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
- `src/lib/csvParser.js` ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ CSV
- `src/lib/blocklist.js` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –±–ª–æ–∫-–ª–∏—Å—Ç–∞–º–∏
- `src/lib/reasonTexts.js` ‚Äî —Ç–µ–∫—Å—Ç—ã –æ—à–∏–±–æ–∫
- `src/scheduler/followup.js` ‚Äî –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
- `PROJECT_STRUCTURE.md` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
- **–ö—Ä–∏—Ç–∏—á–Ω–æ**: –£–¥–∞–ª–µ–Ω —Ö–∞—Ä–¥–∫–æ–¥ API –∫–ª—é—á–∞ Mailboxlayer
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ –º–æ–¥—É–ª—è—Ö
- –£–±—Ä–∞–Ω—ã —Å—Ç—Ä–∞–Ω–Ω—ã–µ UUID –∏–∑ –∫–æ–¥–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `MAILBOXLAYER_API_KEY` –≤ .env

### üì¶ –†–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–æ
- –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π `server.js` (912 —Å—Ç—Ä–æ–∫) ‚Üí –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥—É–ª—è—Ö
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- –ü–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## –ú–∏–≥—Ä–∞—Ü–∏—è

### 1. –û–±–Ω–æ–≤–∏—Ç–µ .env —Ñ–∞–π–ª

–î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
```bash
MAILBOXLAYER_API_KEY=your_key_here
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
npm install
```

–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Å—Ç–∞–ª–∏—Å—å –ø—Ä–µ–∂–Ω–∏–º–∏, –Ω–∏—á–µ–≥–æ –Ω–æ–≤–æ–≥–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

–§–∞–π–ª `src/config/emailValidation.json` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏.
–ï—Å–ª–∏ –≤—ã –µ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª–∏ ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã.

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
npm start
```

–°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ –∏ –≤—ã–≤–µ—Å—Ç–∏:
```
‚úÖ Server listening on port 3000
üìÅ Data directory: /path/to/data
üåê Base URL: https://your-domain.com
üìß SendGrid: configured
ü§ñ Telegram bot: enabled
```

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

#### API
```bash
curl http://localhost:3000/health
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"ok":true}
```

#### –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞
```bash
curl -X POST http://localhost:3000/api/send \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","text":"Test message"}'
```

#### –ú–µ—Ç—Ä–∏–∫–∏
```bash
curl http://localhost:3000/api/series?days=7
```

#### –í–µ–±-–¥–∞—à–±–æ—Ä–¥
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://localhost:3000/`

#### Telegram –±–æ—Ç
–û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –≤–∞—à–µ–º—É –±–æ—Ç—É

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### API
‚úÖ –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ—Å—Ç–∞–ª–∏—Å—å –ø—Ä–µ–∂–Ω–∏–º–∏:
- `POST /api/send`
- `POST /sendgrid/events`
- `POST /sendgrid/inbound`
- `GET /api/series`
- `GET /health`

### –î–∞–Ω–Ω—ã–µ
‚úÖ –§–æ—Ä–º–∞—Ç –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è:
- `db.json`
- `counters.json`
- `tokens`
- `config.json`

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚úÖ –í—Å–µ ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ.
‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è: `MAILBOXLAYER_API_KEY`

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### –û—à–∏–±–∫–∞: "Cannot find module"
```bash
npm install
```

### –û—à–∏–±–∫–∞: "MAILBOXLAYER_API_KEY not set"
–≠—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ. –í–∞–ª–∏–¥–∞—Ü–∏—è email –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ Mailboxlayer (—Ç–æ–ª—å–∫–æ DNS).
–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Mailboxlayer ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –≤ .env.

### –û—à–∏–±–∫–∞: "SENDGRID_API_KEY not set"
–î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á SendGrid –≤ .env:
```bash
SENDGRID_API_KEY=SG.xxxxx
```

### Telegram –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. `TELEGRAM_BOT_TOKEN` –≤ .env
2. –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω (–≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "Telegram bot: enabled")
3. –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö

### –í–µ–±-–¥–∞—à–±–æ—Ä–¥ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
2. –ü–æ—Ä—Ç –Ω–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
3. –§–∞–π–ª—ã –≤ `public/` –Ω–∞ –º–µ—Å—Ç–µ

## –û—Ç–∫–∞—Ç –Ω–∞ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–º–º–∏—Ç:

```bash
git log --oneline  # –Ω–∞–π–¥–∏—Ç–µ —Ö–µ—à –∫–æ–º–º–∏—Ç–∞ –¥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
git checkout <hash>
npm install
npm start
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATA_DIR/activity.log`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATA_DIR/logs/{id}.log` –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∏—Å—å–º–∞
4. –û—Ç–∫—Ä–æ–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
